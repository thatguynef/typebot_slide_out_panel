<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Typebot Slide-out Panel Demo</title>

  <style>
    /* 
      1. CSS VARIABLES 
      Defining the variables required by your ask-ai.css 
    */
    :root {
      /* Panel Dimensions & Speed */
      --ai-panel-width: 400px;
      --ai-transition-speed: 0.4s;
      --ai-z-index: 9999;
      
      /* Colors (Dark Theme for Panel) */
      --ai-panel-bg: #151515;
      --ai-panel-border: #333333;
      --ai-text-color: #ffffff;
      
      /* Panel Content Background */
      --bg-primary: #1e1e1e; 

      /* Shadows */
      --ai-sidebar-box-shadow: -5px 0 25px rgba(0,0,0,0.3);
    }

    /* 
      2. PAGE BASE STYLES 
      Just to make the demo page look decent 
    */
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      margin: 0;
      padding: 0;
      background-color: #f4f4f5;
      color: #333;
      line-height: 1.6;
    }

    .main-container {
      max-width: 800px;
      margin: 100px auto;
      padding: 2rem;
      text-align: center;
    }

    h1 { margin-bottom: 1rem; }
    p { margin-bottom: 2rem; color: #666; }

    /* The Trigger Button Style */
    .btn-primary {
      display: inline-block;
      padding: 12px 24px;
      background-color: #ff1e4d;
      color: white;
      text-decoration: none;
      border-radius: 8px;
      font-weight: 600;
      border: none;
      cursor: pointer;
      transition: background-color 0.2s;
    }
    .btn-primary:hover {
      background-color: #d50e39;
    }

    /* 
      3. PROVIDED CSS (ask-ai.css) 
    */
    /* --- The Slide-out Panel --- */
    .ask-ai-panel {
      position: fixed;
      top: 0;
      right: 0;
      width: var(--ai-panel-width);
      height: 100vh;
      background-color: var(--ai-panel-bg);
      border-left: 1px solid var(--ai-panel-border);
      z-index: var(--ai-z-index);
      display: flex;
      flex-direction: column;
      
      /* Initial State: Hidden off-screen to the right */
      transform: translateX(100%);
      transition: transform var(--ai-transition-speed) cubic-bezier(0.16, 1, 0.3, 1),
                  width var(--ai-transition-speed) ease-in-out;
      box-shadow: var(--ai-sidebar-box-shadow);
    }

    /* Open State */
    .ask-ai-panel.is-open {
      transform: translateX(0);
    }

    /* Expanded State (Wide Mode) */
    .ask-ai-panel.is-expanded {
      width: 700px; /* Adjust based on your 'On this page' sidebar width */
      max-width: 90vw;
    }

    /* --- Panel Header --- */
    .ask-ai-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1rem 1.5rem;
      border-bottom: 1px solid var(--ai-panel-border);
      background-color: var(--ai-panel-bg);
    }

    .ask-ai-title {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      color: var(--ai-text-color);
      font-weight: 600;
      font-size: 1rem;
    }

    .ask-ai-controls {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .ask-ai-icon-btn {
      background: transparent;
      border: none;
      color: #888;
      cursor: pointer;
      padding: 0.4rem;
      border-radius: 6px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: color 0.2s, background 0.2s;
    }

    .ask-ai-icon-btn:hover {
      color: var(--ai-text-color);
      background-color: rgba(255,255,255,0.05);
    }

    /* --- Panel Content (Typebot Area) --- */
    .ask-ai-content {
      flex: 1;
      position: relative;
      overflow: hidden; 
      background-color: var(--bg-primary);
    }
    
    /* Typebot element styling to ensure full fit */
    typebot-standard {
      width: 100%;
      height: 100%;
      display: block;
    }

    /* --- Mobile Responsiveness --- */
    @media (max-width: 768px) {
      .ask-ai-panel {
        /* On mobile, cover the full screen or leave a small gap at top */
        width: 100%;
        top: 0px; 
        height: 100vh; 
        border-left: none;
        border-top: 1px solid var(--ai-panel-border);
      }
      
      /* Disable width expansion on mobile since it's already full width */
      .ask-ai-panel.is-expanded {
        width: 100%; 
      }

      /* Hide the expand button on mobile */
      #ask-ai-expand {
        display: none;
      }
    }
  </style>
</head>
<body>

  <!-- Main Page Content -->
  <div class="main-container">
    <h1>Documentation Page</h1>
    <p>This is a sample page content. Click the button below to ask the AI assistant.</p>
    
    <!-- Trigger Button -->
    <button class="js-ask-ai-trigger btn-primary">
      Ask AI Helper
    </button>
    
    <p style="margin-top: 2rem; font-size: 0.9rem;">
      (Try clicking, closing, and using the expand button inside the panel)
    </p>
  </div>


  <!-- 
    SLIDE-OUT PANEL HTML STRUCTURE 
  -->
  <div id="ask-ai-panel" class="ask-ai-panel" aria-hidden="true">
    
    <!-- Header -->
    <div class="ask-ai-header">
      <div class="ask-ai-title">
        <!-- Simple AI Icon SVG -->
<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 18 18" class="size-5 text-primary dark:text-primary-light"><g fill="currentColor"><path d="M5.658,2.99l-1.263-.421-.421-1.263c-.137-.408-.812-.408-.949,0l-.421,1.263-1.263,.421c-.204,.068-.342,.259-.342,.474s.138,.406,.342,.474l1.263,.421,.421,1.263c.068,.204,.26,.342,.475,.342s.406-.138,.475-.342l.421-1.263,1.263-.421c.204-.068,.342-.259,.342-.474s-.138-.406-.342-.474Z" fill="currentColor" data-stroke="none" stroke="none"></path><polygon points="9.5 2.75 11.412 7.587 16.25 9.5 11.412 11.413 9.5 16.25 7.587 11.413 2.75 9.5 7.587 7.587 9.5 2.75" fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5"></polygon></g></svg>
        AI Assistant
      </div>
      <div class="ask-ai-controls">
        <!-- Expand Button -->
        <button id="ask-ai-expand" class="ask-ai-icon-btn" title="Expand view">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <polyline points="15 3 21 3 21 9"></polyline>
            <polyline points="9 21 3 21 3 15"></polyline>
            <line x1="21" y1="3" x2="14" y2="10"></line>
            <line x1="3" y1="21" x2="10" y2="14"></line>
          </svg>
        </button>
        <!-- Close Button -->
        <button id="ask-ai-close" class="ask-ai-icon-btn" title="Close">
          <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <line x1="18" y1="6" x2="6" y2="18"></line>
            <line x1="6" y1="6" x2="18" y2="18"></line>
          </svg>
        </button>
      </div>
    </div>

    <!-- Content Area -->
    <div class="ask-ai-content">
      <!-- Typebot Container Element -->
      <typebot-standard></typebot-standard>
    </div>
  </div>


  <!-- 
    JAVASCRIPT 
  -->
  <script type="module">
    // 1. Import Typebot
    import Typebot from 'https://cdn.jsdelivr.net/npm/@typebot.io/js@0/dist/web.js'

    // 2. Initialize Typebot
    // This looks for the <typebot-standard> tag and injects the bot there
    Typebot.initStandard({
      typebot: "typebot-slide-out-panel-demo",
    });

    // 3. PROVIDED JS (ask-ai.js) - Wrapped in the same module scope
    document.addEventListener('DOMContentLoaded', () => {
      // Select ALL buttons with the class 'js-ask-ai-trigger'
      const triggerBtns = document.querySelectorAll('.js-ask-ai-trigger');
      const panel = document.getElementById('ask-ai-panel');
      const closeBtn = document.getElementById('ask-ai-close');
      const expandBtn = document.getElementById('ask-ai-expand');

      // Check if essential elements exist
      if (triggerBtns.length === 0 || !panel || !closeBtn) return;

      // --- Functions ---

      function openPanel() {
        panel.classList.add('is-open');
        panel.setAttribute('aria-hidden', 'false');
        
        // Lock Body Scroll
        document.body.style.overflow = 'hidden';

        // Update state for ALL trigger buttons
        triggerBtns.forEach(btn => {
          btn.classList.add('is-active');
          btn.setAttribute('aria-expanded', 'true');
        });
      }

      function closePanel() {
        panel.classList.remove('is-open');
        panel.setAttribute('aria-hidden', 'true');
        
        // Unlock Body Scroll
        document.body.style.overflow = '';

        // Update state for ALL trigger buttons
        triggerBtns.forEach(btn => {
          btn.classList.remove('is-active');
          btn.setAttribute('aria-expanded', 'false');
        });
      }

      function togglePanel() {
        if (panel.classList.contains('is-open')) {
          closePanel();
        } else {
          openPanel();
        }
      }

      // --- Event Listeners ---

      // 1. Loop through all trigger buttons and add click listeners
      triggerBtns.forEach(btn => {
        btn.addEventListener('click', (e) => {
          e.preventDefault(); 
          e.stopPropagation();
          togglePanel();
        });
      });

      // 2. Click on Close X Button
      closeBtn.addEventListener('click', (e) => {
        e.stopPropagation();
        closePanel();
      });

      // 3. Click on Expand/Collapse Button (Desktop only)
      if (expandBtn) {
        expandBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          const isExpanded = panel.classList.toggle('is-expanded');

          // Swap the Icon SVG based on state
          if (isExpanded) {
            expandBtn.setAttribute('title', 'Collapse view');
            expandBtn.innerHTML = `
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="4 14 10 14 10 20"></polyline>
                <polyline points="20 10 14 10 14 4"></polyline>
                <line x1="14" y1="10" x2="21" y2="3"></line>
                <line x1="3" y1="21" x2="10" y2="14"></line>
              </svg>`;
          } else {
            expandBtn.setAttribute('title', 'Expand view');
            expandBtn.innerHTML = `
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="15 3 21 3 21 9"></polyline>
                <polyline points="9 21 3 21 3 15"></polyline>
                <line x1="21" y1="3" x2="14" y2="10"></line>
                <line x1="3" y1="21" x2="10" y2="14"></line>
              </svg>`;
          }
        });
      }

      // 4. Close on ESC key press
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape' && panel.classList.contains('is-open')) {
          closePanel();
        }
      });
    });
  </script>

</body>
</html>
